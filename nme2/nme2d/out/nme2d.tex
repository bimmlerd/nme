\documentclass{article}
% generated by Madoko, version 0.9.2-beta
%mdk-data-line={1}

\usepackage[heading-base=2]{madoko}
\usepackage{mathtools}


\begin{document}
%mdk-data-line={8}
{}\mdTitle{Problem Sheet 2}
\mdSubtitle{Numerical Methods for CSE}
\mdAuthor{David Bimmler}{}{}{}
\mdMaketitle{}
\mdHxx[id=sec-lyapunov-equation,label={[1]\{.heading-label\}},toc={},data-line={10},caption={[[1]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}Lyapunov Equation},bookmark={1.{\hspace{0.5em}}Lyapunov Equation}]{%mdk-data-line={10}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1}.{\hspace{0.5em}}}%mdk-data-line={10}
{}Lyapunov Equation}\mdHxxx[id=sec-linear-mapping,label={[1.a]\{.heading-label\}},toc={},data-line={11},caption={[[1.a]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}Linear Mapping},bookmark={1.a.{\hspace{0.5em}}Linear Mapping}]{%mdk-data-line={11}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.a}.{\hspace{0.5em}}}%mdk-data-line={11}
{}Linear Mapping}\begin{mdP}[class={para-continue},data-line={13}]%
%mdk-data-line={13}
{}To prove (for %mdk-data-line={13}
{}\mdSpan[class={math-inline},elem={math-inline}]{$\mathbf{U}, \mathbf{V} \in \mathbb{R}^{n,n}, \alpha \in \mathbb{R}$}%mdk-data-line={13}
{} and a fixed %mdk-data-line={13}
{}\mdSpan[class={math-inline},elem={math-inline}]{$\mathbf{A}$}%mdk-data-line={13}
{}):%
\end{mdP}%
\begin{mdUl}[class={ul,list-dash,compact},elem={ul},data-line={15}]%
\begin{mdLi}[class={li,ul-li,list-dash-li,compact-li},label={[(1)]\{.ul-li-label\}},elem={li},data-line={15}]%
%mdk-data-line={15}
{}\mdSpan[class={math-inline},elem={math-inline}]{$L(\mathbf{U + V}) = L(\mathbf{U}) + L(\mathbf{V})$}%mdk-data-line={15}
{}%
\end{mdLi}%
\begin{mdLi}[class={li,ul-li,list-dash-li,compact-li},label={[(2)]\{.ul-li-label\}},elem={li},data-line={16}]%
%mdk-data-line={16}
{}\mdSpan[class={math-inline},elem={math-inline}]{$L(\alpha \cdot \mathbf{U}) = \alpha \cdot L(\mathbf{U})$}%mdk-data-line={16}
{}%
\end{mdLi}%%
\end{mdUl}%
\begin{mdP}[class={para-continue},data-line={18}]%
%mdk-data-line={18}
{}The first property:%
\end{mdP}%
\begin{mdDiv}[class={math,para-block},elem={math},data-line={19}]%
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={20}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={20}
\begin{aligned}
L(\mathbf{U}+\mathbf{V})&=\mathbf{A}(\mathbf{U}+\mathbf{V})+(\mathbf{U}+\mathbf{V})\mathbf{A}^{T} \\
&=\mathbf{AU}+\mathbf{AV}+\mathbf{UA}^{T}+\mathbf{VA}^{T} \\
&=\mathbf{AU}+\mathbf{UA}^{T}+\mathbf{AV}+\mathbf{VA}^{T} \\
&=L(\mathbf{U})+L(\mathbf{V})
\end{aligned}
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%
\begin{mdP}[class={para-continue},data-line={28}]%
%mdk-data-line={28}
{}And the second property:%
\end{mdP}%
\begin{mdDiv}[class={math,para-block},elem={math},data-line={29}]%
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={30}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={30}
\begin{aligned}
 L(\alpha\cdot\mathbf{U}) &= \mathbf{A}(\alpha\cdot\mathbf{U}) + (\alpha\cdot\mathbf{U})\mathbf{A}^T \\
 &= \alpha \cdot (\mathbf{AU}) + \alpha\cdot(\mathbf{UA}^{T})\\
 &= \alpha \cdot (L(\mathbf{U}))
 \end{aligned}
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%
\mdHxxx[id=sec-linear-equations,label={[1.c]\{.heading-label\}},toc={},data-line={37},caption={[[1.c]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}Linear Equations},bookmark={1.c.{\hspace{0.5em}}Linear Equations}]{%mdk-data-line={37}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.c}.{\hspace{0.5em}}}%mdk-data-line={37}
{}Linear Equations}\begin{mdP}[class={para-continue},data-line={39}]%
%mdk-data-line={39}
{}We have%
\end{mdP}%
\begin{mdDiv}[class={math,para-block},elem={math},data-line={40}]%
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={41}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={41}
\begin{bmatrix}2 & 1 \\ -1 & 3 \end{bmatrix} \mathbf{X} + \mathbf{X} \begin{bmatrix} 2 & 1 \\ -1 & 3 \end{bmatrix} = \mathbf{I}
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%
\begin{mdP}[class={para-continue},data-line={44}]%
%mdk-data-line={44}
{}This gives us the following equations:%
\end{mdP}%
\begin{mdDiv}[class={math,para-block},elem={math},data-line={45}]%
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={46}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={46}
\begin{aligned}
1 &= 2 \mathbf{X}_{11} + \mathbf{X}_{21} + 2 \mathbf{X}_{11} + \mathbf{X}_{11} = 4 \mathbf{X}_{11} + \mathbf{X}_{21} + \mathbf{X}_{12} \\
0 &= - \mathbf{X}_{11} + 5 \mathbf{X}_{21} + \mathbf{X}_{22} \\
0 &= - \mathbf{X}_{11} + 5 \mathbf{X}_{12} + \mathbf{X}_{22} \\
1 &= - \mathbf{X}_{21} - \mathbf{X}_{12} + 6 \mathbf{X}_{21}
\end{aligned}
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%
\begin{mdP}[class={para-continue},data-line={54}]%
%mdk-data-line={54}
{}For this %mdk-data-line={54}
{}\mdSpan[class={math-inline},elem={math-inline}]{$\mathbf{A}$}%mdk-data-line={54}
{} %mdk-data-line={54}
{}\mdSpan[class={math-inline},elem={math-inline}]{$(6)$}%mdk-data-line={54}
{} is thus%
\end{mdP}%
\begin{mdDiv}[class={math,para-block},elem={math},data-line={56}]%
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={57}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={57}
\begin{bmatrix}
4  & 1 & 1 & 0 \\
-1 & 5 & 0 & 1 \\
-1 & 0 & 5 & 1 \\
0 & -1 & -1 & 6
\end{bmatrix}
\cdot
\begin{bmatrix}
\mathbf{X}_{11} \\ \mathbf{X}_{21} \\ \mathbf{X}_{12} \\ \mathbf{X}_{22}
\end{bmatrix}
=
\begin{bmatrix}
1 \\ 0 \\ 0 \\ 1
\end{bmatrix}
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%
\mdHxxx[id=sec-general-mathbfc,label={[1.d]\{.heading-label\}},toc={},data-line={73},caption={[[1.d]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}General \${\textbackslash}mathbf\{C\}\$},bookmark={1.d.{\hspace{0.5em}}General \${\textbackslash}mathbf\{C\}\$}]{%mdk-data-line={73}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.d}.{\hspace{0.5em}}}%mdk-data-line={73}
{}General %mdk-data-line={73}
{}\mdSpan[class={math-inline},elem={math-inline}]{$\mathbf{C}$}}\begin{mdDiv}[class={equation,para-block},label={[(1)]\{.equation-label\}},elem={equation},line-adjust={0},data-line={75}]%
%mdk-data-line={75}
{}\mdSpan[class={equation-before}]{\mdSpan[class={equation-label}]{(1)}}%mdk-data-line={75}
{}
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={76}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={76}
C = kron(A, I) + kron(I, A)
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%
\mdHxxx[id=sec-matlab-buildc,label={[1.e]\{.heading-label\}},toc={},data-line={81},caption={[[1.e]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}Matlab `buildC`},bookmark={1.e.{\hspace{0.5em}}Matlab `buildC`}]{%mdk-data-line={81}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.e}.{\hspace{0.5em}}}%mdk-data-line={81}
{}Matlab %mdk-data-line={81}
{}\mdCode[class={code,code1}]{buildC}}\begin{mdPre}[class={para-block,pre-fenced,pre-fenced3},data-line={83},data-line-code={84;code/buildC.m:1}]%
\mdPrecode[data-line={84;code/buildC.m:1}]{function\prespace{1}C\prespace{1}=\prespace{1}buildC(\prespace{1}A\prespace{1})\prebr{}
\preindent{4}n\prespace{1}=\prespace{1}length(A);\prebr{}
\preindent{4}I\prespace{1}=\prespace{1}eye(n);\prebr{}
\preindent{4}C\prespace{1}=\prespace{1}kron(A,I)\prespace{1}+\prespace{1}kron(I,A);\prebr{}
end\prebr{}
\prebr{}
}%
\end{mdPre}%
\mdHxxx[id=sec-upper-bound-for-nnzc,label={[1.f]\{.heading-label\}},toc={},data-line={87},caption={[[1.f]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}Upper bound for `nnz(C)`},bookmark={1.f.{\hspace{0.5em}}Upper bound for `nnz(C)`}]{%mdk-data-line={87}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.f}.{\hspace{0.5em}}}%mdk-data-line={87}
{}Upper bound for %mdk-data-line={87}
{}\mdCode[class={code,code1}]{nnz(C)}}\mdHxxx[id=sec-eigenfont-variantsmall-caps-implementation-of-buildc,label={[1.g]\{.heading-label\}},toc={},data-line={89},caption={[[1.g]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}[Eigen]\{font-variant=small-caps\} implementation of `buildC`},bookmark={1.g.{\hspace{0.5em}}Eigen implementation of `buildC`}]{%mdk-data-line={89}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.g}.{\hspace{0.5em}}}%mdk-data-line={89}
{}\mdSpan[font-variant={small-caps}]{Eigen}%mdk-data-line={89}
{} implementation of %mdk-data-line={89}
{}\mdCode[class={code,code1}]{buildC}}\mdHxxx[id=sec-verifying-correctness-of-buildc,label={[1.h]\{.heading-label\}},toc={},data-line={91},caption={[[1.h]\{.heading-label\}.{\hspace{0.5em}}]\{.heading-before\}Verifying Correctness of `buildC`},bookmark={1.h.{\hspace{0.5em}}Verifying Correctness of `buildC`}]{%mdk-data-line={91}
{}\mdSpan[class={heading-before}]{\mdSpan[class={heading-label}]{1.h}.{\hspace{0.5em}}}%mdk-data-line={91}
{}Verifying Correctness of %mdk-data-line={91}
{}\mdCode[class={code,code1}]{buildC}}\begin{mdP}[class={para-continue},data-line={93}]%
%mdk-data-line={93}
{}Both implementations gave the following matrix:%
\end{mdP}%
\begin{mdDiv}[class={math,para-block},elem={math},data-line={95}]%
\begin{mdDiv}[class={mathdisplay,para-block,input-math},elem={mathdisplay},color={},math-needpdf={},line-adjust={0},data-line={96}]%
\begin{mdDiv}[class={mathdisplay,math-display},color={},math-needpdf={}]%
\[%mdk-data-line={96}
\begin{bmatrix}
20 &  2 &  3 &  4 &  5 &  2 &  0 &  0 &  0 &  0 &  3 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 &  0 &  0 &  0 \\
6  & 30 &  8 &  9 &  1 &  0 &  2 &  0 &  0 &  0 &  0 &  3 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 &  0 &  0 \\
1  & 2  & 40 &  4 &  5 &  0 &  0 &  2 &  0 &  0 &  0 &  0 &  3 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 &  0 \\
6  & 7  & 8  & 30 &  0 &  0 &  0 &  0 &  2 &  0 &  0 &  0 &  0 &  3 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 \\
1  & 2  & 3  & 4  & 20 &  0 &  0 &  0 &  0 &  2 &  0 &  0 &  0 &  0 &  3 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 \\
6  & 0  & 0  & 0  & 0  & 30 &  2 &  3 &  4 &  5 &  8 &  0 &  0 &  0 &  0 &  9 &  0 &  0 &  0 &  0 &  1 &  0 &  0 &  0 &  0 \\
0  & 6  & 0  & 0  & 0  & 6  & 40 &  8 &  9 &  1 &  0 &  8 &  0 &  0 &  0 &  0 &  9 &  0 &  0 &  0 &  0 &  1 &  0 &  0 &  0 \\
0  & 0  & 6  & 0  & 0  & 1  & 2  & 50 &  4 &  5 &  0 &  0 &  8 &  0 &  0 &  0 &  0 &  9 &  0 &  0 &  0 &  0 &  1 &  0 &  0 \\
0  & 0  & 0  & 6  & 0  & 6  & 7  & 8  & 40 &  0 &  0 &  0 &  0 &  8 &  0 &  0 &  0 &  0 &  9 &  0 &  0 &  0 &  0 &  1 &  0 \\
0  & 0  & 0  & 0  & 6  & 1  & 2  & 3  & 4  & 30 &  0 &  0 &  0 &  0 &  8 &  0 &  0 &  0 &  0 &  9 &  0 &  0 &  0 &  0 &  1 \\
1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 0  & 40 &  2 &  3 &  4 &  5 &  4 &  0 &  0 &  0 &  0 &  5 &  0 &  0 &  0 &  0 \\
0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 6  & 50 &  8 &  9 &  1 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 &  0 &  0 \\
0  & 0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 1  & 2  & 60 &  4 &  5 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 &  0 \\
0  & 0  & 0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 6  & 7  & 8  & 50 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 &  0 \\
0  & 0  & 0  & 0  & 1  & 0  & 0  & 0  & 0  & 2  & 1  & 2  & 3  & 4  & 40 &  0 &  0 &  0 &  0 &  4 &  0 &  0 &  0 &  0 &  5 \\
6  & 0  & 0  & 0  & 0  & 7  & 0  & 0  & 0  & 0  & 8  & 0  & 0  & 0  & 0  & 30 &  2 &  3 &  4 &  5 &  0 &  0 &  0 &  0 &  0 \\
0  & 6  & 0  & 0  & 0  & 0  & 7  & 0  & 0  & 0  & 0  & 8  & 0  & 0  & 0  & 6  & 40 &  8 &  9 &  1 &  0 &  0 &  0 &  0 &  0 \\
0  & 0  & 6  & 0  & 0  & 0  & 0  & 7  & 0  & 0  & 0  & 0  & 8  & 0  & 0  & 1  & 2  & 50 &  4 &  5 &  0 &  0 &  0 &  0 &  0 \\
0  & 0  & 0  & 6  & 0  & 0  & 0  & 0  & 7  & 0  & 0  & 0  & 0  & 8  & 0  & 6  & 7  & 8  & 40 &  0 &  0 &  0 &  0 &  0 &  0 \\
0  & 0  & 0  & 0  & 6  & 0  & 0  & 0  & 0  & 7  & 0  & 0  & 0  & 0  & 8  & 1  & 2  & 3  & 4  & 30 &  0 &  0 &  0 &  0 &  0 \\
1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 0  & 3  & 0  & 0  & 0  & 0  & 4  & 0  & 0  & 0  & 0  & 20 &  2 &  3 &  4 &  5 \\
0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 0  & 3  & 0  & 0  & 0  & 0  & 4  & 0  & 0  & 0  & 6  & 30 &  8 &  9 &  1 \\
0  & 0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 0  & 3  & 0  & 0  & 0  & 0  & 4  & 0  & 0  & 1  & 2  & 40 &  4 &  5 \\
0  & 0  & 0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 0  & 3  & 0  & 0  & 0  & 0  & 4  & 0  & 6  & 7  & 8  & 30 &  0 \\
0  & 0  & 0  & 0  & 1  & 0  & 0  & 0  & 0  & 2  & 0  & 0  & 0  & 0  & 3  & 0  & 0  & 0  & 0  & 4  & 1  & 2  & 3  & 4  & 20
\end{bmatrix}
\]%
\end{mdDiv}%%
\end{mdDiv}%%
\end{mdDiv}%


\end{document}
